@page
@model Pages.Admin.BlazorAdmin.Components.DispatcherMapModalModel
<div class="modal fade" id="mapModal" tabindex="-1" aria-labelledby="mapModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-lg modal-dialog-centered">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="mapModalLabel">Technician Location</h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body position-relative">
                @if (Model.ShowMap && Model.Lat.HasValue && Model.Lng.HasValue)
                {
                    <div class="d-flex flex-column flex-md-row align-items-center justify-content-between mb-2">
                        <div>
                            <label class="form-check-label me-2">
                                <input type="checkbox" class="form-check-input" name="FollowTech" value="true" @(Model.FollowTech ? "checked" : "") />
                                Follow Technician
                            </label>
                            @if (Model.IsSimulated)
                            {
                                <span class="badge bg-warning ms-2">Simulated</span>
                            }
                        </div>
                        @if (Model.IsDevelopment)
                        {
                            <div class="dev-controls mt-2 mt-md-0">
                                <button class="btn btn-outline-success btn-sm me-2" onclick="startSimulation()" @(Model.IsSimulated ? "disabled" : "")>Start Simulation</button>
                                <button class="btn btn-outline-danger btn-sm" onclick="stopSimulation()" @(!Model.IsSimulated ? "disabled" : "")>Stop Simulation</button>
                            </div>
                        }
                    </div>
                    <!-- TechnicianMap partial or JS map here -->
                    <div id="technicianMap"></div>
                }
                else
                {
                    <div class="text-muted">No GPS data available for this technician.</div>
                }
                <div class="d-md-none d-block position-absolute top-0 end-0 p-2">
                    <button class="btn btn-light btn-sm" data-bs-dismiss="modal">Close</button>
                </div>
            </div>
            <div class="modal-footer d-md-none d-block">
                <small class="text-muted">Mobile: Pinch/zoom and drag to explore the map.</small>
            </div>
        </div>
    </div>
</div>
@section Scripts {
<script>
function startSimulation() { /* JS to start simulation */ }
function stopSimulation() { /* JS to stop simulation */ }
</script>
}