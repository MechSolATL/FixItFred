@model MVP_Core.Data.Models.TechnicianProfileDto
<div class="modal fade" id="techProfileModal" tabindex="-1" aria-labelledby="techProfileModalLabel" aria-hidden="true" data-tech-id="@Model.Id">
  <div class="modal-dialog modal-lg">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title" id="techProfileModalLabel">Technician Profile: @Model.FullName</h5>
        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
      </div>
      <div class="modal-body">
        <div class="row">
          <div class="col-md-3 text-center">
            @if (!string.IsNullOrEmpty(Model.PhotoUrl))
            {
                <img src="@Model.PhotoUrl" class="img-fluid rounded mb-2" alt="Technician Photo" style="max-height:120px;" />
            }
            <div class="mb-2">
              <span class="badge bg-success">@Model.Specialty</span>
            </div>
            @if (!string.IsNullOrEmpty(Model.Badges))
            {
                var badges = System.Text.Json.JsonSerializer.Deserialize<List<string>>(Model.Badges);
                if (badges != null)
                {
                    foreach (var badge in badges)
                    {
                        <span class="badge bg-info text-dark me-1">@badge</span>
                    }
                }
            }
          </div>
          <div class="col-md-9">
            <dl class="row mb-0">
              <dt class="col-sm-4">Email</dt>
              <dd class="col-sm-8">@Model.Email</dd>
              <dt class="col-sm-4">Phone</dt>
              <dd class="col-sm-8">@Model.Phone</dd>
              <dt class="col-sm-4">Birthday</dt>
              <dd class="col-sm-8">@Model.Birthday?.ToString("yyyy-MM-dd")</dd>
              <dt class="col-sm-4">Employment Date</dt>
              <dd class="col-sm-8">@Model.EmploymentDate?.ToString("yyyy-MM-dd")</dd>
              <dt class="col-sm-4">Active</dt>
              <dd class="col-sm-8">@(Model.IsActive ? "Yes" : "No")</dd>
              <dt class="col-sm-4">Skills</dt>
              <dd class="col-sm-8">@string.Join(", ", Model.Skills)</dd>
            </dl>
            <hr />
            <div class="row text-center">
              <div class="col">
                <div class="h5">@Model.CompletedJobs</div>
                <div class="small text-muted">Completed Jobs</div>
              </div>
              <div class="col">
                <div class="h5">@Model.Callbacks</div>
                <div class="small text-muted">Callbacks</div>
              </div>
              <div class="col">
                <div class="h5">@Model.CloseRate:P0</div>
                <div class="small text-muted">Close Rate</div>
              </div>
              <div class="col">
                <div class="h5">@Model.AvgReviewScore</div>
                <div class="small text-muted">Avg. Review</div>
              </div>
              <div class="col">
                <div class="h5">@Model.ReviewCount</div>
                <div class="small text-muted">Reviews</div>
              </div>
            </div>
            <div class="mt-3">
              <button class="btn btn-outline-primary btn-sm me-2" onclick="exportTechProfile(@Model.Id, 'csv')">Export CSV</button>
              <button class="btn btn-outline-secondary btn-sm" onclick="exportTechProfile(@Model.Id, 'pdf')">Export PDF</button>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>
<script>
function exportTechProfile(techId, type) {
    window.open(`/Admin/TechnicianProfile/Export${type.toUpperCase()}?techId=${techId}`, '_blank');
}
</script>
