@page
@model MVP_Core.Pages.Customer.DocumentsModel
@inject MVP_Core.Services.CustomerPortalService PortalService
@{
    Layout = "/Pages/Shared/_Layout.cshtml";
    if (!User.Identity.IsAuthenticated || !User.HasClaim("IsCustomer", "true"))
    {
        <div class="alert alert-danger">Access denied. Please log in as a customer.</div>
        return;
    }
    var email = User.Identity.Name ?? string.Empty;
    var docs = PortalService.GetDocuments(email);
}
<h2>Documents</h2>
<table class="table table-bordered">
    <thead><tr><th>Date</th><th>Status</th><th>Amount</th><th>Download</th></tr></thead>
    <tbody>
    @foreach (var doc in docs)
    {
        <tr>
            <td>@doc.InvoiceDate.ToShortDateString()</td>
            <td>@doc.Status</td>
            <td>@doc.AmountDue.ToString("C")</td>
            <td><a href="@doc.LinkUrl" target="_blank" class="btn btn-sm btn-outline-primary">PDF</a></td>
        </tr>
    }
    </tbody>
</table>
