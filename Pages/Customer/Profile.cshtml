@page
@model MVP_Core.Pages.Customer.ProfileModel
@inject MVP_Core.Services.CustomerPortalService PortalService
@{
    Layout = "/Pages/Shared/_Layout.cshtml";
    if (!User.Identity.IsAuthenticated || !User.HasClaim("IsCustomer", "true"))
    {
        <div class="alert alert-danger">Access denied. Please log in as a customer.</div>
        return;
    }
    var email = User.Identity.Name ?? string.Empty;
    var customer = PortalService.GetCustomer(email);
}
<h2>Profile & Preferences</h2>
@if (customer != null)
{
    <form method="post">
        <div class="mb-2">
            <label>Name</label>
            <input type="text" name="Name" class="form-control" value="@customer.Name" />
        </div>
        <div class="mb-2">
            <label>Email</label>
            <input type="email" name="Email" class="form-control" value="@customer.Email" />
        </div>
        <div class="mb-2">
            <label>Phone</label>
            <input type="text" name="Phone" class="form-control" value="@customer.Phone" />
        </div>
        <div class="mb-2">
            <label>Address</label>
            <input type="text" name="Address" class="form-control" value="@customer.Address" />
        </div>
        <button type="submit" class="btn btn-primary">Save Changes</button>
    </form>
}
else
{
    <div class="alert alert-warning">Profile not found.</div>
}
